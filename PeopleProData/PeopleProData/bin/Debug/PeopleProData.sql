/*
Deployment script for PeopleProData

This code was generated by a tool.
Changes to this file may cause incorrect behavior and will be lost if
the code is regenerated.
*/

GO
SET ANSI_NULLS, ANSI_PADDING, ANSI_WARNINGS, ARITHABORT, CONCAT_NULL_YIELDS_NULL, QUOTED_IDENTIFIER ON;

SET NUMERIC_ROUNDABORT OFF;


GO
:setvar DatabaseName "PeopleProData"
:setvar DefaultFilePrefix "PeopleProData"
:setvar DefaultDataPath "C:\Users\ortegadr\AppData\Local\Microsoft\VisualStudio\SSDT\PeopleProData"
:setvar DefaultLogPath "C:\Users\ortegadr\AppData\Local\Microsoft\VisualStudio\SSDT\PeopleProData"

GO
:on error exit
GO
/*
Detect SQLCMD mode and disable script execution if SQLCMD mode is not supported.
To re-enable the script after enabling SQLCMD mode, execute the following:
SET NOEXEC OFF; 
*/
:setvar __IsSqlCmdEnabled "True"
GO
IF N'$(__IsSqlCmdEnabled)' NOT LIKE N'True'
    BEGIN
        PRINT N'SQLCMD mode must be enabled to successfully execute this script.';
        SET NOEXEC ON;
    END


GO
USE [$(DatabaseName)];


GO
/*
Post-Deployment Script Template							
--------------------------------------------------------------------------------------
 This file contains SQL statements that will be appended to the build script.		
 Use SQLCMD syntax to include a file in the post-deployment script.			
 Example:      :r .\myfile.sql								
 Use SQLCMD syntax to reference a variable in the post-deployment script.		
 Example:      :setvar TableName MyTable							
               SELECT * FROM [$(TableName)]					
--------------------------------------------------------------------------------------
*/
MERGE INTO Department AS TARGET
USING (VALUES
	(1, 'School of Engineering'),
	(2, 'School of Liberal Arts'),
	(3, 'School of Science and Mathematics')
)
AS SOURCE (DepartmentId, [Name])
ON TARGET.DepartmentId = SOURCE.DepartmentId
WHEN NOT MATCHED BY TARGET THEN
INSERT([Name]) VALUES ([Name]);

MERGE INTO Building AS Target
USING (VALUES
	(1, '1 Campus Wy', 'Kelley Engineering Center', 1),
	(2, '2 Campus Wy', 'Bexell Hall', 2),
	(3, '3 Campus Wy', 'Kidder Hall', 3)
)
AS Source (BuildingId, [Address], [Name], [DepartmentId])
ON Target.BuildingId = Source.BuildingId
WHEN NOT MATCHED BY TARGET THEN
INSERT ([Address], [Name], [DepartmentId]) VALUES([Address], [Name], [DepartmentId]);

MERGE INTO Employee AS Target
USING (VALUES
	(1, 'Drew', 1),
	(2, 'Max', 2),
	(3, 'Jeff', 3)
)
AS Source (EmployeeId, [FirstName], [DepartmentId])
ON Target.EmployeeId = Source.EmployeeId
WHEN NOT MATCHED BY TARGET THEN
INSERT ([FirstName], [DepartmentId]) VALUES([FirstName], [DepartmentId]);
GO

GO
PRINT N'Update complete.';


GO
